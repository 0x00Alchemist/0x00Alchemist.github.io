<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Discover a clean and straightforward Jekyll blogging theme with our simple and minimal template. Github Pages ready, user-friendly design, easy to set up and low maintenance, letting you focus on creating content."><link rel="stylesheet" href="http://localhost:4000/assets/css/syntax.css"><link rel="preconnect" href="https://cdnjs.cloudflare.com"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><title> Как мы на Kaspersky в KSE охотились - alchemist.</title><link rel="shortcut icon" href="http://localhost:4000/favicon.png"><link rel="alternate" type="application/atom+xml" title="alchemist." href="http://localhost:4000/atom.xml"><link rel="alternate" type="application/json" title="alchemist." href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="http://localhost:4000/sitemap.xml" /><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&family=Source+Code+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,300;1,400;1,500;1,600;1,700;1,900&display=swap" rel="stylesheet"><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}html{font-size:15px}#theme-toggle{opacity:.65;position:relative;border-radius:5px;height:25px;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;transition:opacity .3s ease 0s;border:none;outline:none;background:none;cursor:pointer;padding:0px;appearance:none;transform:scale(0.8)}html,html[data-theme=light]{--text-font: Play;--source-code-font: Source Code Pro;--very-light-text-color: rgb(222, 222, 222);--light-text-color: rgb(89, 183, 255);--medium-text-color: #555;--main-text-color: #333;--highlight-text-color: #6cb4a0;--dark-text-color: #393e46;--link-color: rgb(50, 87, 209);--code-bg-color: rgb(245, 245, 245);background-color:#fff}html #theme-toggle div,html[data-theme=light] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:none;background-color:var(--theme-ui-colors-transparent, transparent);transform:scale(1);transition:all .45s ease 0s;overflow:hidden;box-shadow:inset 8px -8px 0px 0px var(--theme-ui-colors-toggleIcon, #2d3748)}html #theme-toggle div::before,html[data-theme=light] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:none;border-radius:50%;transform:translate(0px, 0px);opacity:1;transition:transform .45s ease 0s}html #theme-toggle div::after,html[data-theme=light] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),0 23px 0 var(--theme-ui-colors-toggleIcon, #2d3748),23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),-23px 0 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #2d3748);transform:scale(0);transition:all .35s ease 0s}html[data-theme=dark]{--text-font: Play;--source-code-font: Source Code Pro;--very-light-text-color: #EEE;--light-text-color: #c4bbf0;--medium-text-color: #52057b;--main-text-color: #EAEAEA;--highlight-text-color: #6cb4a0;--dark-text-color: rgb(36, 38, 42);--link-color: rgb(255, 89, 125);--code-bg-color: rgb(36, 38, 42);background-color:#131418}html[data-theme=dark] #theme-toggle div{position:relative;width:24px;height:24px;border-radius:50%;border:4px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);background-color:var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(0.55);transition:all .45s ease 0s;overflow:visible;box-shadow:none}html[data-theme=dark] #theme-toggle div::before{content:"";position:absolute;right:-9px;top:-9px;height:24px;width:24px;border:2px solid var(--theme-ui-colors-toggleIcon, #cbd5e0);border-radius:50%;transform:translate(14px, -14px);opacity:0;transition:transform .45s ease 0s}html[data-theme=dark] #theme-toggle div::after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0px 0px -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),0 23px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-23px 0 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px 15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0),-15px -15px 0 var(--theme-ui-colors-toggleIcon, #cbd5e0);transform:scale(1);transition:all .35s ease 0s}body{font-family:var(--text-font),monospace;text-rendering:optimizeLegibility;line-height:1.75;color:var(--main-text-color)}a{color:var(--link-color);text-decoration:none}.post p{margin:1rem 0}.meta{margin:1.4rem 0}code,pre{background:var(--code-bg-color);margin:0 -27px;border-width:1px}code{font-family:var(--source-code-font),monospace;margin:unset;padding:.1rem;color:var(--highlight-text-color)}pre code{background-color:unset;color:unset}pre{border-width:3px;padding:.8rem;white-space:pre-wrap;border-style:none none none solid;border-color:var(--light-text-color)}img{max-width:100%}hr{background:var(--light-text-color);height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem 0}section{margin-top:5.5rem}blockquote{font-style:italic;border-left:5px solid var(--dark-text-color);padding-left:1rem}h1{color:var(--main-text-color);text-transform:uppercase;font-size:2rem;font-weight:bold;margin-bottom:1.5rem}h2,h3,h4,h5{font-weight:bold;margin-bottom:1.5rem;font-size:2rem}h2{font-size:1.8rem}h3{font-size:1.6rem}h4{font-size:1.4rem}h5{font-size:1.2rem}h6{font-size:1rem}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts>h3{font-weight:500}.post ul{margin:0px;margin:0px 0px 10px 10px}.post ol{margin:0px;margin:0px 0px 10px 15px}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}time{color:var(--main-text-color)}.post>h1.title{font-size:x-large;margin-top:0;margin-bottom:0}.post>time{margin-bottom:0;margin-top:3rem}.highlight{margin:0px}main{display:flex;max-width:47rem;margin:-5rem auto 0;padding:2.4rem 2rem;flex-direction:column}.flex-row-between{display:flex;flex-direction:row;justify-content:space-between}.social-footer{padding:1rem;display:flex;justify-content:center;position:initial}.social-footer .social-footer-icons .fa{font-size:1.3rem;color:#a9a9a9}.social-footer .social-footer-icons .fa:hover{color:dimgray;transition:color .3s ease-in}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}main{padding:0 2rem}}section{flex-grow:999;display:flex;flex-direction:column}figcaption{font-size:smaller}.bio{margin-bottom:5rem}::selection{background-color:#fffba0;color:#333}.search-article{position:relative}.search-article label[for=search-input]{position:relative;top:-10px;left:11px}.search-article input[type=search]{top:-1rem;left:0;border:0;width:100%;height:30px;outline:none;position:absolute;border-radius:5px;padding:10px 10px 10px 35px;color:var(--main-text-color);-webkit-appearance:none;background-color:rgba(128,128,128,.1);border:1px solid rgba(128,128,128,.1)}.search-article input[type=search]::-webkit-input-placeholder{color:gray}.search-article input[type=search]::-webkit-search-decoration,.search-article input[type=search]::-webkit-search-results-decoration{display:none}#search-results{list-style:none;text-align:center}#search-results li{text-align:center}#search-results li::before{content:"›";display:inline-block;margin-left:-1.3em;width:1.3em;color:var(--main-text-color)}.post-nav{display:flex;position:relative;margin-top:0;border-top:2px solid var(--light-text-color);line-height:1.4}.post-nav .post-nav-item{border-bottom:0;padding-bottom:10px;width:50%;padding-top:10px;text-decoration:none;box-sizing:border-box}.post-nav .post-nav-item .post-title{color:var(--main-text-color)}.post-nav .post-nav-item:hover .post-title,.post-nav .post-nav-item:focus .post-title{color:var(--link-color);opacity:.9}.post-nav .post-nav-item .nav-arrow{font-size:17px;color:var(--main-text-color);margin-bottom:3px;font-weight:bold}.post-nav .post-nav-item:nth-child(odd){padding-left:0;padding-right:20px}.post-nav .post-nav-item:nth-child(even){text-align:right;padding-right:0;padding-left:20px}.tags ul{list-style:none;display:grid;grid-template-columns:auto auto auto auto auto auto;grid-template-rows:auto auto auto auto}.tags li{white-space:normal;text-overflow:ellipsis}.timeline{position:center;width:650px;margin:-6em auto;padding:1px;list-style-type:none}@media(max-width: 860px){.timeline{width:100%}}.timeline:before{position:absolute;left:50%;top:0;content:" ";display:block;width:6px;height:100%;margin-left:-3px;background:var(--light-text-color);z-index:5}@media(max-width: 375px){.timeline:before{height:150%}}.timeline li{padding:2em 0}@media(max-width: 860px){.timeline li{padding:2em 0}}.timeline li::after{content:"";display:block;height:150%;clear:both;visibility:hidden}.direction-l{position:relative;width:287px;float:left;text-align:right}@media(max-width: 860px){.direction-l{float:none;width:100%;text-align:center}}.direction-l .flag{color:#333;box-shadow:-1px 1px 1px rgba(0,0,0,.52)}.direction-l .flag:after{content:"";position:absolute;left:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid rgba(0,0,0,0);border-left-color:#f8f8f8;border-width:8px;pointer-events:none}@media(max-width: 860px){.direction-l .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid rgba(0,0,0,0);border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-l .time-wrapper{float:left}@media(max-width: 860px){.direction-l .time-wrapper{float:none}}.direction-r{position:relative;width:293px;float:right;text-align:left}@media(max-width: 860px){.direction-r{float:none;width:100%;text-align:center}}.direction-r .flag{color:#333;box-shadow:1px 1px 1px rgba(0,0,0,.52)}.direction-r .flag:after{content:"";position:absolute;right:100%;top:50%;height:0;width:0;margin-top:-8px;border:solid rgba(0,0,0,0);border-right-color:#f8f8f8;border-width:8px;pointer-events:none}@media(max-width: 860px){.direction-r .flag:after{content:"";position:absolute;left:50%;top:-8px;height:0;width:0;margin-left:-8px;border:solid rgba(0,0,0,0);border-bottom-color:#fff;border-width:8px;pointer-events:none}}.direction-r .flag:before{left:-40px}.direction-r .time-wrapper{float:right}@media(max-width: 860px){.direction-r .time-wrapper{float:none}}.flag-wrapper{position:relative;display:inline-block;text-align:center}@media(max-width: 860px){.flag-wrapper{text-align:center}}.flag-wrapper .flag{position:relative;display:inline;background:#f8f8f8;padding:6px 10px;border-radius:5px;font-weight:600;text-align:left}@media(max-width: 860px){.flag-wrapper .flag{background:#fff;z-index:15}}.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:60%;right:-40px;content:" ";display:block;width:12px;height:12px;margin-top:-10px;background:#fff;border-radius:10px;border:4px solid var(--link-color);z-index:10}@media(max-width: 860px){.direction-l .flag:before,.direction-r .flag:before{position:absolute;top:-30px;left:53%;content:" ";display:block;margin-left:-10px}}.time-wrapper{display:inline;line-height:1em;font-size:.66666em;color:var(--link-color);vertical-align:middle}@media(max-width: 860px){.time-wrapper{display:block;position:relative;margin:4px 0 0 0;z-index:14}}.time-wrapper .time{display:inline-block;padding:4px 6px;background:#f8f8f8}.desc{margin:1em .2em -3.5em 0;font-size:.9em;line-height:1.5em}.desc a{color:var(--link-color);text-decoration:none}.desc a:hover{text-decoration:underline}@media(max-width: 860px){.desc{position:relative;margin:1em 1em 0 1em;padding:1em;background:var(--code-bg-color);box-shadow:0 0 1px rgba(0,0,0,.2);z-index:15}}</style></head><body><main><section class="post"><div class="flex-row-between"> <a href="http://localhost:4000/">« back</a> <button title="Change theme" id="theme-toggle" onclick="modeSwitcher()"><div></div></button></div><time datetime="2021-12-02T00:00:00+02:00">Dec 2, 2021 - 5 ' read</time><h1 class="title"> Как мы на Kaspersky в KSE охотились</h1><span class="meta"> <a href="http://localhost:4000/tag/Windows">Windows</a>, <a href="http://localhost:4000/tag/AV">AV</a>, <a href="http://localhost:4000/tag/KSE">KSE</a></span><p>Где-то примерно неделю назад один мой коллега приметил одну замечательную вещь: Kaspersky интересным образом протянул свои ручки к Kernel Shim Engine.</p><p>В итоге мы собрались где-то вчера разгребать и смотреть, что он там забыл. Также попытались распилить и отловить шим Касперского, но об этом чуть позже.</p><h2 id="вводные"> Вводные <a href="#вводные">#</a></h2><p>Начнем с понимания, что это вообще за зверь такой - Kernel Shim Engine. Технически Kernel Shim Engine (далее KSE) предоставляет “обертки” для драйверов устройств, а также обеспечивает дополнительную поддержку и обработку ошибок драйверов устройств. У него есть своя специальная база данных, мы затронем её позже.</p><p>Также стоит поговорить о кое чем еще.</p><h2 id="инициализация-шимов"> Инициализация шимов <a href="#инициализация-шимов">#</a></h2><p>Если говорить в кратце и не вдаваться в подробности работы, то шимы инициализируются на этапе загрузки системы, где-то сразу после того, как инциализировался HAL (Hardware Abstraction Layer) и WMI (Windows Management Instrumentation) с ETW (Event Tracing for Windows). После прогрузки HAL, WMI и ETW вызывается функция <code class="language-plaintext highlighter-rouge">KseInitialize()</code>, а после нее <code class="language-plaintext highlighter-rouge">KseRegisterShim()</code>. Эти функции официально не документированы, но находятся в некоторых заголовочных файлах WDK.</p><h2 id="инициализация-built-in-шимов-драйверов"> Инициализация “Built-in” шимов драйверов <a href="#инициализация-built-in-шимов-драйверов">#</a></h2><p>В конце инициализации HAL происходит инициализация шима <code class="language-plaintext highlighter-rouge">DriverScope</code>, этот шим преоставляется по стандарту системой: <img src="https://telegra.ph/file/6a7e823e4f6994c25239a.png" alt="" /></p><p>Затем, во время инициализации WMI/ETW также инициализируется функция <code class="language-plaintext highlighter-rouge">KseVersionLieInitialize()</code>. Данная функция инициализирует шимы <code class="language-plaintext highlighter-rouge">KmWin7VersionLie</code>, <code class="language-plaintext highlighter-rouge">KmWin8VersionLie</code> и <code class="language-plaintext highlighter-rouge">KmWin81VersionLie</code> (хоть тесты и производились на десятке, но подобный шим с версией “10” я не обнаружил): <img src="https://telegra.ph/file/6696892d9103caf951ff6.png" alt="" /></p><p>Потом вызывается функция <code class="language-plaintext highlighter-rouge">KseSkipDriverUnloadInitialize()</code>, которая инициализирует шим <code class="language-plaintext highlighter-rouge">SkipDriverUnload</code>.</p><h2 id="функции-касперского-в-ядре"> Функции Касперского в ядре <a href="#функции-касперского-в-ядре">#</a></h2><p>Окей, вроде +- разобрались. Теперь, какие функции были найдены мной, затрагивающие шимы:</p><p><img src="https://telegra.ph/file/7503d5cdb5fbbe607e2ea.png" alt="" /></p><p>Доступ был только к функции к <code class="language-plaintext highlighter-rouge">KseKasperskyInitialize()</code>: <img src="https://telegra.ph/file/454425e15d9dc8fbc91b7.png" alt="" /></p><p>Сперва мы решили посмотреть, как поведет себя Касперский при манипуляции с реестром, а конкретнее:</p><ul><li><code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Policies\Microsoft\Compatibility</code> С ключами DisableDeviceFlags и DisableDriverShims (REG_DWORD), их значения равны единицы, очевидно по названиям ключей, что они делают при значении 0x01.</li><li><code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Compatibility</code> С ключем DisableFlags (REG_DWORD) со значением 0x01 (отключает функциональность драйвера).</li></ul><p><img src="https://telegra.ph/file/d28d92c33c10e020b0a13.png" alt="" /></p><p><img src="https://telegra.ph/file/7882dbc6a7958bb351b22.png" alt="" /></p><p>В нашем случае Касперский никак себя не повел, тем более он спокойно дал изменить значения регистров, т.е эти ключи реестра не мониторятся Касперским.</p><h2 id="как-поломать-kse"> Как поломать KSE <a href="#как-поломать-kse">#</a></h2><p>Можно сломать KSE двумя путями: мониторинг драйвера через Verifier и с помощью удаления drvmain.sdb. Мы вполне имеем право поставить Verifier на драйвер Касперского, ну или удалить сам drvmain.sdb, но скорее всего это вызовет BSOD.</p><h2 id="drvmainsdb"> drvmain.sdb <a href="#drvmainsdb">#</a></h2><p>Мы все же решили для начала порыться в drvmain.sdb. Стоит сказать, что до мониторинга и удаления мы не дошли, а почему - вы поймете позже.</p><p>drvmain.sdb - стандартная база данных “легальных” драйверов и не только. Помимо драйверов, там также находится информация о шимах и других вещах. Этот файл находится в “%systemroot%/apppatch/”. Файлы с расширением sdb можно открыть, к примеру, через SDBExplorer.</p><p>Видим в drvmain вот такую картину: <img src="https://telegra.ph/file/43166105e211864bb3a9d.png" alt="" /></p><p>Да, список драйверов Касперского, ничего удивительного. Можно было бы ставить Verifier на klhk.sys и идти отлавливать шим Касперского, но не все так просто.</p><h2 id="kshim-и-почему-все-печально-закончилось"> KSHIM и почему все печально закончилось <a href="#kshim-и-почему-все-печально-закончилось">#</a></h2><p>В drvmain, как и упоминалось выше, есть не только перечисление драйверов, а также некоторые шимы. Представляются они в виде структуры KSHIM, которая по сути является структурой KSE_SHIM, только слегка измененной:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>typedef struct _KSE_SHIM {
  _In_ ULONG Size;
  _In_ PGUID ShimGuid;
  _In_ PWCHAR ShimName;
  _Out_ PVOID KseCallbackRoutines;
  _Inopt_ PVOID ShimmedDriverTargetedNotification;
  _Inopt_ PVOID ShimmedDriverUntargetedNotification;
  _In_ PVOID HookCollectionsArray;
} KSE_SHIM, *PKSE_SHIM;
</code></pre></div></div><p>Вот как выглядит KSHIM Касперского: <img src="https://telegra.ph/file/6de97f18ed595c54a1a32.png" alt="" /></p><p>Заметьте, что поле MODULE несет значение “NT kernel component”. А теперь можем посмотреть на ndis шимы: <img src="https://telegra.ph/file/d9be19f43a929c8b93057.png" alt="" /></p><p>Да, тут поле MODULE со значением “ndis”. Думаю, можно догадаться, в чем проблема.</p><p>Ага, это значит, что шим Касперского существует в пространстве самого ядра системы. А это значит, что кроме как накидывая Verifier на ядро мы отследить шим Касперского не сможем. Вот, только если накидывать его на ядро, сломается не только Касперский, но и сама система. Прикольно, правда?</p><h2 id="возможный-путь-отлова-шима-касперского"> Возможный путь отлова шима Касперского <a href="#возможный-путь-отлова-шима-касперского">#</a></h2><p>В мою голову лезет только анализ дампа системы. Т.е мы должны завершить систему аварийно, при этом сгенерировав дамп системы, где был запущен Касперский. Команда “.crash” (если не ошибаюсь) из windbg вполне решит эту проблему. Я, правда, не уверен, что мы сможем вытащить что-то дельное, но попытка не пытка, как говорится.</p><h2 id="послесловие-и-догадки"> Послесловие и догадки <a href="#послесловие-и-догадки">#</a></h2><p>Теоретически, <code class="language-plaintext highlighter-rouge">_KSE_SHIM</code> - пользовательский ввод. Есть смысл посидеть над драйвером ndis.sys (сама структура оттуда). Однако, стучать туда через непривелегированного пользователя мы не сможем, но вполне вероятно, что до туда сможет достать TrustedInstaller.</p></section><section><nav class="post-nav"> <a class="post-nav-item post-nav-next" href="/2022/11/18/driver-signature-enforcement-%D0%B8%D0%BB%D0%B8-%D0%B8%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D0%B5%D0%BC-dse"><div class="nav-arrow">Next</div><span class="post-title">Drowning In The Kernel - Driver Signature Enforcement!</span> </a></nav></section><div id="disqus_thread" class="article-comments"></div><script> (function() { var d = document, s = d.createElement('script'); s.src = '//____SKVLLZ..disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></main><script> function setTheme(theme) { if (theme === "dark") { document.documentElement.setAttribute('data-theme', 'dark'); window.localStorage.setItem('theme', 'dark'); document.getElementById("theme-toggle").classList.add('sun'); document.getElementById("theme-toggle").classList.remove('moon'); } else { document.documentElement.setAttribute('data-theme', 'light'); window.localStorage.setItem('theme', 'light'); document.getElementById("theme-toggle").classList.add('moon'); document.getElementById("theme-toggle").classList.remove('sun'); } } let theme = localStorage.getItem('theme'); theme = theme || (window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light' : 'light'); setTheme(theme); function modeSwitcher() { let currentMode = document.documentElement.getAttribute('data-theme'); if (currentMode === "dark") { setTheme('light'); } else { setTheme('dark'); } } </script></body><footer class="social-footer"><div class="social-footer-icons"> <a href="https://github.com/0x00Alchemist" title="Github profile" target="_blank" rel="noopener noreferrer"><i class="fa fa-brands fa-github" aria-hidden="true"></i></a> <a href="http://localhost:4000/atom.xml" title="Feed RSS" target="_blank" rel="noopener noreferrer"><i class="fa fa-solid fa-rss" aria-hidden="true"></i></a> <a href="https://github.com/DavideBri/Gesko" title="Browse the code" target="_blank" rel="noopener noreferrer"><i class="fa fa-solid fa-code" aria-hidden="true"></i></a></div></footer></html>
